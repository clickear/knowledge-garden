---
date created: 2022-09-05
date modified: 2022-09-05
title: 颜色指针
---

> [!INFO] 颜色指针  
> 以前的垃圾回收器的GC信息都**保存在对象头**中，而ZGC的[[ZGC]]信息**保存在指针**中

![](http://image.clickear.top/20210913171746.png)  
每个对象有一个64位指针，这64位被分为：

- 18位：预留给以后使用；
- 1位：Finalizable标识，次位与并发引用处理有关，它表示这个对象只能通过finalizer才能访问；
- 1位：Remapped标识，设置此位的值后，对象未指向relocation set中（relocation set表示需要GC的Region集合）；
- 1位：Marked1标识；
- 1位：Marked0标识，和上面的Marked1都是标记对象用于辅助GC；
- 42位：对象的地址（所以它可以支持2^42=4T内存）

> [!INFO] 颜色指针最大支持到16T  
>  既然低42位指针可以支持4T内存，那么能否通过预约更多位给对象地址来达到支持更大内存的目的呢？答案肯定是不可以。因为目前主板地址总线最宽只有48bit，4位是颜色位，就只剩44位了，所以受限于目前的硬件，ZGC最大只能支持16T的内存，JDK13就把最大支持堆内存从4T扩大到了16T




