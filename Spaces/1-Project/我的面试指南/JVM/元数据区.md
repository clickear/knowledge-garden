---
aliaes: [æ°¸ä¹…ä»£]
date created: 2022-09-02
date modified: 2022-09-05
title: å…ƒæ•°æ®åŒº
---

> [!TIP] æŠ€å·§ðŸ’¡  
> JDK1.7å« **æ°¸ä¹…ä»£** ï¼Œæœ¬è´¨æ€§ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å¯¹ JVM è§„èŒƒä¸­æ–¹æ³•åŒºçš„å®žçŽ°ã€‚æœ€å¤§çš„åŒºåˆ«åœ¨äºŽï¼šå…ƒæ•°æ®ç©ºé—´å¹¶ä¸åœ¨**è™šæ‹Ÿæœº**ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨**æœ¬åœ°å†…å­˜**

åœ¨JDK1.8ä¹‹åŽï¼Œå±žäºŽæœ¬åœ°å†…å­˜ï¼Œè€Œä¸æ˜¯jvmå†…å­˜ã€‚

1. æ°¸ä¹…ä»£å…ƒæ•°æ® -ä¸»è¦ç”¨äºŽå­˜å‚¨ç±»çš„ä¿¡æ¯ã€å¸¸é‡æ± ã€æ–¹æ³•æ•°æ®ã€æ–¹æ³•ä»£ç ç­‰
2. æ°¸ä¹…ä»£å¿…é¡»æŒ‡å®šå¤§å°é™åˆ¶ï¼ˆå±žäºŽjvmå†…å­˜ï¼‰ï¼Œå…ƒæ•°æ®å¯ä»¥è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œæ— ä¸Šé™ï¼ˆå—é™ä¸Žç‰©ç†å†…å­˜ï¼‰ å±žäºŽæœ¬åœ°å†…å­˜
3. æ¼”è¿›åŽ†å²
	1. jdk1.6: æœ‰æ°¸ä¹…ä»£ï¼Œé™æ€å˜é‡å­˜æ”¾åœ¨æ°¸ä¹…ä»£ä¸Š
	2. jdk1.7: æœ‰æ°¸ä¹…ä»£ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ä¿å­˜åœ¨å †ä¸­
	3. jdk1.8: æ— æ°¸ä¹…ä»£ï¼Œ å­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ä¿å­˜åœ¨å †ä¸­ï¼Œå…ƒç©ºé—´ä¸ºå †å¤–å†…å­˜
4. MethodAreaé€»è¾‘æ¦‚å¿µ - æ°¸ä¹…ä»£ã€å…ƒæ•°æ®

## æ–¹æ³•åŒºçš„æ¼”è¿›

+ JDK 1.6ä¹‹å‰(æœ‰æ°¸ä¹…ä»£ï¼Œé™æ€å˜é‡å­˜æ”¾åœ¨æ°¸ä¹…ä»£ä¸Š)

  > ![](http://image.clickear.top/20210828155848.png)

+ JDK 1.7(æœ‰æ°¸ä¹…ä»£ï¼Œä½†å·²ç»é€æ­¥åŽ»æ°¸ä¹…ä»£ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œé™æ€å˜é‡ç§»é™¤ï¼Œä¿å­˜åœ¨å †ä¸­)

  > ![](http://image.clickear.top/20210828155923.png)
  

+ JDK 1.8ä»¥åŠä¹‹åŽï¼ˆæ— æ°¸ä¹…ä»£ï¼Œç±»åž‹ä¿¡æ¯ã€å­—æ®µã€æ–¹æ³•ã€å¸¸é‡ä¿å­˜åœ¨æœ¬åœ°å†…å­˜çš„å…ƒç©ºé—´ï¼Œä½†å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œé™æ€å˜é‡ä»åœ¨å †ï¼‰

  > ![](http://image.clickear.top/20210828155951.png)
  >

## æ°¸ä¹…ä»£ä¸ºä»€ä¹ˆè¢«å…ƒç©ºé—´æ›¿æ¢ï¼ˆæ°¸ä¹…ä»£ç©ºé—´ä¸å¥½è®¾ç½®å¤§å°ï¼Œæ€•åŠ¨æ€åŠ è½½ç±»å¤šï¼Œå½±å“æ°¸ä¹…ä»£å¤§å°ï¼‰

> éšç€ JAVA8çš„åˆ°æ¥ï¼ŒHotSpotVMä¸­å†ä¹Ÿè§ä¸åˆ°æ°¸ä¹…ä»£äº†ï¼Œä½†æ˜¯å¹¶ä¸æ„å‘³ç€ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ä¹Ÿæ¶ˆå¤±äº†ï¼Œè¿™äº›æ•°æ®è¢«è½¬ç§»åˆ°äº†ä¸€ä¸ªä¸Žå †ä¸ç›¸è¿žçš„æœ¬åœ°å†…å­˜åŒºåŸŸï¼Œè¿™ä¸ªåŒºåŸŸå«åšå…ƒç©ºé—´MetaSpace

1. ç”±äºŽç±»çš„å…ƒæ•°æ®åˆ†é…åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼Œå…ƒç©ºé—´çš„æœ€å¤§å¯åˆ†é…ç©ºé—´å°±æ˜¯ç³»ç»Ÿçš„å¯ç”¨å†…å­˜ç©ºé—´
2. ä¸ºæ°¸ä¹…ä»£è®¾ç½®ç©ºé—´å¤§å°å¾ˆéš¾ç¡®å®šï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¦‚æžœåŠ¨æ€åŠ è½½ç±»è¿‡å¤šï¼Œå°±å®¹æ˜“äº§ç”ŸOOM
3. è€Œå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶
4. å¯¹æ°¸ä¹…ä»£è¿›è¡Œè°ƒä¼˜æ˜¯å¾ˆå›°éš¾çš„

## StringTableä¸ºä»€ä¹ˆè¦è°ƒæ•´ï¼Ÿï¼ˆåœ¨æ°¸ä¹…ä»£å›žæ”¶æ•ˆçŽ‡ä½Žï¼‰

> [!TIP] æŠ€å·§ðŸ’¡
> 1. æ°¸ä¹…ä»£é»˜è®¤æƒ…å†µä¸‹æ¯”è¾ƒå°ï¼Œå¤§é‡å­—ç¬¦ä¸²å®¹æ˜“å¯¼è‡´OOMã€‚
>  2. æ°¸ä¹…ä»£åžƒåœ¾å›žæ”¶é¢‘çŽ‡ä½Ž

jdk7ä¸­å°†StringTableæ”¾åˆ°äº†å †ç©ºé—´ä¸­ï¼Œå› ä¸ºæ°¸ä¹…ä»£çš„å›žæ”¶æ•ˆçŽ‡å¾ˆä½Žã€‚åœ¨fullGCçš„æ—¶å€™æ‰è§¦å‘ï¼Œè€ŒfullGCæ˜¯è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œæ°¸ä¹…ä»£ä¸è¶³æ—¶æ‰è§¦å‘è¿™å°±å¯¼è‡´äº†StringTableå›žæ”¶æ•ˆçŽ‡ä¸é«˜ï¼Œè€Œæˆ‘ä»¬å¼€å‘ä¸­ä¼šåˆ›å»ºå¤§é‡çš„å­—ç¬¦ä¸²ï¼Œå›žæ”¶æ•ˆçŽ‡ä½Žï¼Œå¯¼è‡´æ°¸ä¹…ä»£å†…å­˜ä¸è¶³ã€‚æ”¾åˆ°å †é‡Œï¼Œèƒ½åŠæ—¶å›žæ”¶å†…å­˜ã€‚

## æ–¹æ³•åŒºä¼šè¿›è¡Œåžƒåœ¾å›žæ”¶å—ï¼Ÿä¼šï¼Œçœ‹jvmå®žçŽ°

æœ‰äº›äººè®¤ä¸ºæ–¹æ³•åŒºæ˜¯æ²¡æœ‰åžƒåœ¾æ”¶é›†è¡Œä¸ºçš„ï¼Œå…¶å®žä¸ç„¶ã€‚Javaè™šæ‹Ÿæœºè§„èŒƒå¯¹æ–¹æ³•åŒºçš„çº¦æŸéžå¸¸å®½æ¾ï¼Œæåˆ°è¿‡å¯ä»¥ä¸è¦æ±‚è™šæ‹Ÿæœºåœ¨æ–¹æ³•åŒºå®žçŽ°åžƒåœ¾æ”¶é›†ã€‚äº‹å®žä¸Šï¼Œä¹Ÿç¡®å®žæœ‰æœªå®žçŽ°æˆ–æœªèƒ½å®Œæ•´å®žçŽ°æ–¹æ³•åŒºç±»åž‹å¸è½½çš„æ”¶é›†å™¨ï¼Œå¦‚JDK11 ZGc

## å›žæ”¶æ–¹æ³•åŒºå†…å­˜

æ–¹æ³•åŒºä¸­å­˜æ”¾ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ï¼Œæ¯æ¬¡åžƒåœ¾æ”¶é›†åªæœ‰å°‘é‡çš„åžƒåœ¾è¢«æ¸…é™¤ã€‚æ–¹æ³•åŒºä¸­ä¸»è¦æ¸…é™¤ä¸¤ç§åžƒåœ¾ï¼š

- åºŸå¼ƒå¸¸é‡
- æ— ç”¨çš„ç±»

### **åˆ¤å®šåºŸå¼ƒå¸¸é‡**

åªè¦å¸¸é‡æ± ä¸­çš„å¸¸é‡ä¸è¢«ä»»ä½•å˜é‡æˆ–å¯¹è±¡å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™äº›å¸¸é‡å°±ä¼šè¢«æ¸…é™¤æŽ‰ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå­—ç¬¦ä¸² "bingo" è¿›å…¥äº†å¸¸é‡æ± ï¼Œä½†æ˜¯å½“å‰ç³»ç»Ÿæ²¡æœ‰ä»»ä½•ä¸€ä¸ª String å¯¹è±¡å¼•ç”¨å¸¸é‡æ± ä¸­çš„ "bingo" å¸¸é‡ï¼Œä¹Ÿæ²¡æœ‰å…¶å®ƒåœ°æ–¹å¼•ç”¨è¿™ä¸ªå­—é¢é‡ï¼Œå¿…è¦çš„è¯ï¼Œ"bingo"å¸¸é‡ä¼šè¢«æ¸…ç†å‡ºå¸¸é‡æ± ã€‚

### **åˆ¤å®šæ— ç”¨çš„ç±»**

åˆ¤å®šä¸€ä¸ªç±»æ˜¯å¦æ˜¯â€œæ— ç”¨çš„ç±»â€ï¼Œæ¡ä»¶è¾ƒä¸ºè‹›åˆ»ã€‚

- è¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡éƒ½å·²ç»è¢«æ¸…é™¤
- åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›žæ”¶
- è¯¥ç±»çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚

> ä¸€ä¸ªç±»è¢«è™šæ‹ŸæœºåŠ è½½è¿›æ–¹æ³•åŒºï¼Œé‚£ä¹ˆåœ¨å †ä¸­å°±ä¼šæœ‰ä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„å¯¹è±¡ï¼šjava.lang.Classã€‚è¿™ä¸ªå¯¹è±¡åœ¨ç±»è¢«åŠ è½½è¿›æ–¹æ³•åŒºæ—¶åˆ›å»ºï¼Œåœ¨æ–¹æ³•åŒºè¯¥ç±»è¢«åˆ é™¤æ—¶æ¸…é™¤ã€‚
