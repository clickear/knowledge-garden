---
title: HashMap
date created: 2023-01-19
date modified: 2023-01-20
---

[toc]

## HashMapçš„åº•å±‚å®ç°

çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¦‚éœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨[[ConcurrentMap]]

|      | JDK1.7              | JDK1.8                                                              |
|:---- |:------------------- |:------------------------------------------------------------------- |
| ç»“æ„ | æ•°ç»„ + é“¾è¡¨(æ‹‰é“¾æ³•) | æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘(é“¾è¡¨é•¿åº¦>8)                                    |
| æ‰©å®¹ | æ ¹æ®hashé¢‘ç¹è¿ç§»    | åªéœ€çœ‹maskå¤šä¸€ä½ï¼Œå³åªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¥½ |
| çº¿ç¨‹å®‰å…¨     |         å¤´æ’æ³•ï¼Œæ­»å¾ªç¯é—®é¢˜            |         å°¾æ’æ³•ï¼Œå­˜åœ¨è¦†ç›–é—®é¢˜                                                            |

## åº•å±‚ç»“æ„

+ 1.7ï¼š  
![](http://image.clickear.top/20230120112851.png)

+ 1.8:  
![](http://image.clickear.top/20230120112923.png)

+ 1. æ ¹æ®hashç®—æ³•ï¼Œæ‰¾åˆ°æ•°ç»„çš„index,
+ 2. hashå†²çªæ—¶ï¼Œ--> é“¾è¡¨
+ 3. é“¾è¡¨é•¿åº¦ > 8
	+ æ•°ç»„é•¿åº¦ < 64ã€‚é€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹
	+ æ•°ç»„é•¿åº¦ >=64, è½¬æ¢æˆçº¢é»‘æ ‘

### æ‰©å®¹

+ capacity å³å®¹é‡, é»˜è®¤16.
+ loadFactor åŠ è½½å› å­, é»˜è®¤æ˜¯0.75
+ threshold é˜ˆå€¼. é˜ˆå€¼=å®¹é‡*åŠ è½½å› å­. é»˜è®¤12. å½“å…ƒç´ æ•°é‡è¶…è¿‡é˜ˆå€¼æ—¶ä¾¿ä¼šè§¦å‘æ‰©å®¹.

> [!TIP] æŠ€å·§ğŸ’¡  
> æ‰©å®¹æ—¶æœºï¼Œ å½“å…ƒç´ æ•°é‡è¶…è¿‡é˜ˆå€¼æ—¶ä¾¿ä¼šè§¦å‘æ‰©å®¹. æ¯æ¬¡æ‰©å®¹çš„å®¹é‡éƒ½æ˜¯ä¹‹å‰å®¹é‡çš„**2å€ **

JDK1.7:  
æ‰€æœ‰å…ƒç´ éœ€è¦éå†è¿‡å»ï¼Œé‡æ–°è®¡ç®—ä½ç½®ã€‚è¿›è¡Œè¿ç§»ã€‚

JDK1.8:

> [!TIP] æŠ€å·§ğŸ’¡  
> ä»¥2çš„å¹‚æ¬¡æ–¹æ‰©å®¹ï¼Œå³åªéœ€è¦åˆ¤æ–­æ–°å¢ä½çš„bitå³å¯ã€‚è¦ä¹ˆä¸åŠ¨ï¼Œè¦ä¹ˆè½¬ç§»åˆ°æ–°åˆ›å»ºçš„åˆ†åŒºã€‚

ç”±äºæ•°ç»„çš„å®¹é‡æ˜¯ä»¥2çš„å¹‚æ¬¡æ–¹æ‰©å®¹çš„, é‚£ä¹ˆä¸€ä¸ªEntityåœ¨æ‰©å®¹æ—¶, æ–°çš„ä½ç½®è¦ä¹ˆåœ¨åŸä½ç½®, è¦ä¹ˆåœ¨åŸé•¿åº¦+åŸä½ç½®çš„ä½ç½®ã€‚  
![](http://image.clickear.top/20230120114228.png)

![](http://image.clickear.top/20230120114236.png)

### çº¿ç¨‹å®‰å…¨

jdk1.7:  
å¤´æ’æ³•ï¼Œæ­»å¾ªç¯é—®é¢˜

jdk1.8:  
å°¾æ’æ³•ï¼Œä¸å­˜åœ¨æ­»å¾ªç¯ï¼Œä½†æ˜¯å­˜åœ¨æ•°æ®è¦†ç›–é—®é¢˜

```java
final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node<K,V>[] tab; Node<K,V> p; int n, i;
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((p = tab[i = (n - 1) & hash]) == null) // å¦‚æœæ²¡æœ‰hashç¢°æ’åˆ™ç›´æ¥æ’å…¥å…ƒç´ 
            tab[i] = newNode(hash, key, value, null);
        else {
            // ....
        }
        ++modCount;
        if (++size > threshold)  //éåŸå­æ“ä½œï¼Œä¼šæœ‰é—®é¢˜
            resize();
        afterNodeInsertion(evict);
        return null;
    }
```

å­˜åœ¨åŸå› :

1. é¦–æ¬¡æ’å…¥æ—¶ï¼Œå› ä¸ºåˆ¤æ–­éçº¿ç¨‹å®‰å…¨ï¼Œå¯èƒ½Açº¿ç¨‹åˆ¤æ–­ä¸ºç©ºæ•°æ®ï¼Œå‡†å¤‡æ’å…¥èŠ‚ç‚¹ï¼ŒBçº¿ç¨‹ä¹Ÿåˆ¤æ–­çš„æƒ…å†µã€‚æ­¤æ¬¡2ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºèŠ‚ç‚¹ã€‚
2. ++sizeéåŸå­æ€§ï¼Œä¼šå¸¦æ¥é—®é¢˜

## å‚è€ƒèµ„æ–™

[Javaé›†åˆå¸¸è§é¢è¯•é¢˜æ€»ç»“(ä¸‹) | JavaGuide(Javaé¢è¯•+å­¦ä¹ æŒ‡å—)](https://javaguide.cn/java/collection/java-collection-questions-02.html#hashmap-%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0)  
[Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap - ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ](https://tech.meituan.com/2016/06/24/java-hashmap.html)
